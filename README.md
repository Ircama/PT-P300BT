# Printing to a Brother P-Touch Cube PT-P300BT label printer from a computer

## Introduction

The [Brother P-touch Cube PT-P300BT labelling machine](https://support.brother.com/g/b/producttop.aspx?c=gb&lang=en&prod=p300bteuk) is intended to be controlled from the official Brother P-touch Design&Print 2 app for [Android](https://play.google.com/store/apps/details?id=com.brother.ptouch.designandprint2) and [iOS](https://apps.apple.com/it/app/brother-p-touch-design-print/id1105307806) devices, instead of from a computer.

This repository provides small code revision and some additional scripts to:

- [PT-P300BT gist](https://gist.github.com/Ircama/bd53c77c98ecd3d7db340c0398b22d8a)
- [dogtopus/Pipfile gist](https://gist.github.com/dogtopus/64ae743825e42f2bb8ec79cea7ad2057)
- [stecman gist](https://gist.github.com/stecman/ee1fd9a8b1b6f0fdd170ee87ba2ddafd)

Comparing with the PT-P300BT gist, it adds *printlabel.py* and it does not need ImageMagick.

The scripts are used to convert text labels to appropriate images compatible with 12mm width craft tapes like [TZe-131](https://www.brother-usa.com/products/tze131) or [TZe-231](https://www.brother-usa.com/products/tze231). The font is fixed (TrueType ps:[helvetica](https://en.wikipedia.org/wiki/Helvetica)) and the image generation is tuned for the max allowed character size with this printer.

Usage: `python printlabel.py "COM Port" "font name" "label to print"`

The tested font name is "arial.ttf". Examples:

```
python printlabel.py COM7 "arial.ttf" "HELLO WORLD"
```

or:

```
printlabel.exe COM7 "arial.ttf" "Lorem Ipsum"
```

In addition, all *labelmaker.py* options are available:

```
Full usage options: printlabel.py [-h] [-i IMAGE] [-n] [-F NO_FEED] [-a AUTO_CUT] [-m END_MARGIN] [-r] [-C] comport font_name text_to_print

positional arguments:
  comport               Printer COM port.
  font_name             Pathname of the used TrueType font
  text_to_print         Text to be printed

optional arguments:
  -h, --help            show this help message and exit
  -i IMAGE, --image IMAGE
                        Image file to print (ignore text_to_print).
  -n, --no-print        Only configure the printer and send the image but do not send print command.
  -F NO_FEED, --no-feed NO_FEED
                        Disable feeding at the end of the print (chaining).
  -a AUTO_CUT, --auto-cut AUTO_CUT
                        Enable auto-cutting (or print label boundary on e.g. PT-P300BT).
  -m END_MARGIN, --end-margin END_MARGIN
                        End margin (in dots).
  -r, --raw             Send the image to printer as-is without any pre-processing.
  -C, --nocomp          Disable compression.

```

## Windows setup

- Open Windows Settings
- Go to Bluetooth & devices
- Press "View more devices"
- Press "More Bluetooth settings"
- Select "COM Ports" tab
- Press Add... (wait for a while)
- Select Ongoing
- Press Browse...
- Search for PT-P300BT9000 and select it
- Select PT-P300BT9000
- Service: Serial
- Read the name of the COM port
- Press OK
- Press OK

Perform the device peering. 

## Creating an executable asset for the GUI

To build an executable file via [pyinstaller](https://pyinstaller.org/en/stable/), first install *pyinstaller* with `pip install pyinstaller`.

The *printlabel.spec* file helps building the executable program. Run it with the following command.

```
pip install pyinstaller  # if not yet installed
pyinstaller printlabel.spec
```

Then run the executable file created in the *dist/* folder.

This repository includes a Windows *printlabel.exe* executable file which is automatically generated by a [GitHub Action](https://github.com/Ircama/PT-P300BT/blob/main/.github/workflows/build.yml). It is packaged in a ZIP file named *printlabel.zip* and uploaded into the [Releases](https://github.com/Ircama/PT-P300BT/releases/latest) folder.
